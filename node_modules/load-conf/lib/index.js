'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = loadConf;
exports.loadYaml = loadYaml;
exports.loadJson = loadJson;
exports.loadJavaScript = loadJavaScript;

var _fsExtra = require('fs-extra');

var _fsExtra2 = _interopRequireDefault(_fsExtra);

var _jsYaml = require('js-yaml');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function loadConf(path) {
  var defaultsTo = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  var type = arguments[2];

  if (!_fsExtra2.default.existsSync(path)) return defaultsTo;
  switch (type) {
    case 'json':
      return loadJson(path) || defaultsTo;
    case 'yaml':
      return loadYaml(path) || defaultsTo;
    case 'javascript':
      return loadJavaScript(path) || defaultsTo;
  }
  var config = loadJson(path);
  if (!config) config = loadYaml(path);
  if (!config) config = loadJavaScript(path);
  if (!config) config = {};
  return config;
}

function loadYaml(path) {
  try {
    return (0, _jsYaml.safeLoad)(_fsExtra2.default.readFileSync(path, 'utf8'));
  } catch (err) {
    return null;
  }
}

function loadJson(path) {
  try {
    return _fsExtra2.default.readJsonSync(path);
  } catch (err) {
    return null;
  }
}

function loadJavaScript(path) {
  try {
    // eslint-disable-next-line global-require,import/no-dynamic-require
    var config = require(path);
    if (config.default) return config.default;
    return config;
  } catch (err) {
    return null;
  }
}